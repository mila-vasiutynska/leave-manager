-- EMPLOYEES: username + PIN auth (mock)
create table employees (
  emp_id        int primary key,
  username      text unique not null,
  pin           text not null
);

-- Leave balances (hours)
create table leave_balances (
  emp_id int primary key references employees(emp_id),
  annual_hours numeric not null default 0,
  sick_hours   numeric not null default 0
);

-- Leave request header (one per request)
create table leave_requests (
  request_id bigserial primary key,
  emp_id int not null references employees(emp_id),
  leave_type text not null, -- 'annual' | 'sick'
  start_date date not null,
  end_date   date not null,
  status     text not null default 'Pending',
  created_at timestamptz not null default now()
);

-- Daily rows (ERP/M1-style timecards per day of leave)
create table leave_days (
  id bigserial primary key,
  request_id bigint not null references leave_requests(request_id) on delete cascade,
  emp_id int not null,
  day date not null,
  hours numeric not null,
  unique(emp_id, day)
);

-- Seed sample users
insert into employees(emp_id, username, pin) values
(101, 'mila', '1234'),
(102, 'anna', '1111');

insert into leave_balances(emp_id, annual_hours, sick_hours) values
(101, 80, 30),
(102, 40, 10);